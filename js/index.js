async function load(){ const res=await fetch('products.json'); const products=await res.json(); const q=new URLSearchParams(location.search); const brand=q.get('brand')||''; const cond=q.get('condition')||''; const search=(q.get('search')||'').toLowerCase(); const brands=[...new Set(products.map(p=>p.brand))]; document.getElementById('brand').innerHTML='<option value="">Semua Brand</option>'+brands.map(b=>`<option value="${b}">${b}</option>`).join(''); const conds=[...new Set(products.map(p=>p.condition))]; document.getElementById('condition').innerHTML='<option value="">Semua Kondisi</option>'+conds.map(c=>`<option value="${c}">${c}</option>`).join(''); const list=document.getElementById('list'); list.innerHTML=''; products.filter(p=>!brand||p.brand===brand).filter(p=>!cond||p.condition===cond).filter(p=>p.name.toLowerCase().includes(search)).forEach((p,i)=>{ const d=document.createElement('div'); d.className='card'; d.innerHTML=`<img src="${p.image}" alt="${p.name}"/><div class="info"><div class="badge">${p.brand}</div><h3>${p.name}</h3><div class="price">${formatMYR(p.price)}</div><div style="margin-top:8px"><button class="btn" onclick='addToCart({id:"${p.id}",name:"${p.name}",price:${p.price||0}})'>Tambah ke Troli</button> <a class="btn" href="product.html?id=${encodeURIComponent(p.id)}">Lihat</a></div></div>`; list.appendChild(d); }); } document.addEventListener('DOMContentLoaded',load);
