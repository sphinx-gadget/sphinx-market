function renderCart(){ const cart=getCart(); const tbody=document.querySelector('tbody'); const totalEl=document.getElementById('total'); tbody.innerHTML=''; let total=0; cart.forEach((item,i)=>{ total+=item.price*item.qty; const tr=document.createElement('tr'); tr.innerHTML=`<td>${item.name}</td><td>${item.price?('RM '+item.price.toFixed(2)):'-'} </td><td><input type="number" min="1" value="${item.qty}" data-i="${i}" style="width:70px"/></td><td>RM ${(item.price*item.qty).toFixed(2)}</td><td><button data-rm="${i}">Buang</button></td>`; tbody.appendChild(tr); }); totalEl.textContent='RM '+total.toFixed(2); tbody.addEventListener('input',e=>{ if(e.target.matches('input[type="number"]')){ const i=+e.target.dataset.i; const c=getCart(); c[i].qty=Math.max(1,+e.target.value||1); setCart(c); renderCart(); } },{once:true}); tbody.addEventListener('click',e=>{ if(e.target.dataset.rm){ const i=+e.target.dataset.rm; const c=getCart(); c.splice(i,1); setCart(c); renderCart(); } },{once:true}); } function toWhatsApp(){ const cart=getCart(); if(cart.length===0){alert('Troli kosong');return;} const name=document.getElementById('custName').value; const phone=document.getElementById('custPhone').value; const addr=document.getElementById('custAddr').value; const summary=cart.map(i=>`• ${i.name} x${i.qty} — RM ${(i.price*i.qty).toFixed(2)}`).join('%0A'); const total=cart.reduce((s,i)=>s+i.price*i.qty,0).toFixed(2); const text=`Assalamualaikum, saya ingin order:%0A${summary}%0ATotal: RM ${total}%0A%0ANama: ${name}%0ATel: ${phone}%0AAlamat: ${addr}`; const url=`https://wa.me/601157243057?text=${encodeURIComponent(text)}`; window.open(url,'_blank'); } document.addEventListener('DOMContentLoaded',()=>{ renderCart(); document.getElementById('waBtn').addEventListener('click',toWhatsApp); });
